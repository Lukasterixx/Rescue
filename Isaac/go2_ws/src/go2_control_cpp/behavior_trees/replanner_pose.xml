<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="3" main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <RateController hz="5.0">
      <PipelineSequence name="NavigateWithReplanning">
        
        <Fallback name="PlannerSelector">
          
          <Sequence name="CheckPreemptions">
            <Fallback name="NewGoalConditions">
              <GoalUpdated/>
              <GlobalUpdatedGoal/>
            </Fallback>
            <ComputePathToPose
              goal="{goal}"
              start=""
              planner_id="GridBased"
              server_name="compute_path_to_pose"
              server_timeout="5s"
              path="{path}"/>
          </Sequence>

          <DistanceController distance="1.0" global_frame="map2d" robot_base_frame="livox_frame">
            <RateController hz="1.0">
              <Fallback name="PlanIfNeeded">
                <Sequence name="NeedNewPlan">
                  <Fallback name="AnyNeedPlan">
                    <GoalUpdated/>
                    <GlobalUpdatedGoal/> 
                    <Inverter>
                      <IsPathValid path="{path}" server_timeout="2s"/>
                    </Inverter>
                  </Fallback>
                  <ComputePathToPose
                    goal="{goal}"
                    start=""
                    planner_id="GridBased"
                    server_name="compute_path_to_pose"
                    server_timeout="5s"
                    path="{path}"/>
                </Sequence>
                <IsPathValid path="{path}" server_timeout="2s"/>
              </Fallback>
            </RateController>
          </DistanceController>

        </Fallback>
        <FollowPath
          controller_id="FollowPath"
          path="{path}"
          goal_checker_id=""
          server_name="follow_path"
          server_timeout="5s"/>
      </PipelineSequence>
    </RateController>
  </BehaviorTree>
</root>